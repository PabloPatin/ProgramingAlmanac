---
tags:
  - робошкола
---
# Визуальная одометрия (VO)
Метод оценки положения камеры в пространстве через анализ последовательности снимков

Развитием является метод визуальной картографии

Более широкий класс задач - SFM (Structure-from Motion)
Решает проблемы не только определения положения камеры но и 3D-реконструкции сцены
Формируется предварительное представление и итеративно уточняется по массиву данных

С1, С2, С3... - снимки
Т1, Т2, Т3... - массивы перемещения камеры

## Локализация и картографирование
Локализация - отвечает за определение положения
Картографирование - построение модели окружения
Задачи решаются поочерёдно и их решения используют для корректировок друг друга
## Эволюция алгоритмов
1) Вероятностные подходы (PF/EKF)
2) Алгоритмо-аналитические SLAM
3) Робастный метрико-семантический DL-SLAM
Робастность - сохранение свойств при изменении внешних условий

## Методы SLAM
Зависят от:
- Конфигурации датчиков
- Методов комплексирования
- Методов извлечения визуальных признаков

Известные реализации:
- Mono-SLAM, Open-VINS: на основе фильтров
- ORB-SLAM, VINS-Mono: на основе факторных графов
- Kimera, RVWO: семантическая сегментация
- Генераторы новых ракурсов (на основе гауссового расщепления)
## SLAM vs VO
VO обеспечивает локальную согласованность траектории и работает в реальном времени, в то время как SLAM использует VO как один из блоков и обеспечивает глобальную согласованность траектории и карты

Согласованность локальная это когда карта непрерывна, разрывов нет, но при перемещении по кругу он не замыкается, со временем ошибки накапливаются и полной карты не выйдет.

VO даёт преимущество при недоступности глобальных навигационных систем. Она дополняет измерения, которые считываются по другим датчикам.

## Принцип действия  VO
1) Последовательность изображений
2) Обнаружение фич (SIFT, SURF, нейросетевые решения)
3) Сопоставление признаков (трекинг)
4) Оценка движения (по разным схемам 2D-2D, 3D-3D, 3D-3D)
5) Локальная оптимизация
### Дрейф в VO
Шумы и погрешности накапливаются со временем и в результате происходит значительное отклонение предполагаемых координат от действительных
#### Выбор ключевых кадров
Оцениваются не все кадры а только те, между которыми большая база для триангуляции
#### RANSAC
Метод на основе фильтрации выбросов, является стандартом в компьютерном зрении
#### Оптимизация положения камеры скользящим окном
Матрицы преобразований перемножаются, а после дополнительно берутся несмежные кадры для корректировок
#### Уравнивание пучка (Bundle Adjustment)
В качестве целевой функции - минимизация ошибки репроекции.
Предсказание положения фичи для следующего положения камеры сравнивается с её реальным положением, вычисляется ошибка
### Задача релокализации
Локализация в известном окружении:
- Регрессия 3D координаты мира для каждой 2D точки
- Регрессия параметров позы на основе входных данных

## Более современные подходы
Разработки лаборатории СБЕР
### RVWO: робастная визуально-колёсная одометрия в динамических средах
Входные данные
1) Предполагаем, что колёсный робот едет в плоскости
2) Есть монокулярные камеры (обычные)
3) Есть измерения углов поворота колёс

l1, l2, l3... - положение маяков (фичи, их много) записано в виде двумерных координат + угол рысканья
Чем больше маяков, тем лучше обусловлена задача
x1, x2, x3... - положение робота
![[Pasted image 20260225180135.png]]
Целевая функция
![[Pasted image 20260225180626.png]]
Расчёт матриц поворота
![[Pasted image 20260225180842.png]]
Расчёт робастного ядра
![[Pasted image 20260225181015.png]]
Чем более динамичный маркер, тем меньше к нему доверия при возрастании ошибки
Если динамический маркер сместился, то градиентный спуск работать не будет, функция примет вид прямой
$P_s$ - семантическая оценка, основана на методах семантической сегментации. Если фича попала в зону, которая принадлежит семантическому классу подвижного объекта, то будет назначен высокое значение
$P_o$ - геометрическая оценка, берёт в расчёт величину смещения

Пайплайн системы
![[Pasted image 20260225181748.png]]

### Метод визуальной релокализации
Определяет положение в среде о которой уже есть информация
Модель генерирует новые ракурсы в известной среде
Модель обучили на генерацию доп. ракурсов, скормили батч изображений помещения и по заданным координатам она может генерировать новые ракурсы.

Может делать 3D реконструкцию помещения
Замена методов фотограмметрии

Метод использует 3D гауссианы. Каждая гауссиана - примитив (похож на пузырёк). Точка в пространстве, обладающая цветом, ориентацией, радиусом и плотностью
Формула гауссиана
![[Pasted image 20260225183936.png]]

Позиция в декартовых координатах + матрица ковариации 3x3

Построение матрицы ковариации
R - вращение
S - масштаб компоненты
$\sum = RSS^tR^t$

Этот метод ведёт работу не с геометрией, а с дескрипторами
(для распознавания дескрипторов использовалась SD модель)