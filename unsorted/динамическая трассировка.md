---
tags:
  - postgres
---
# Статическая трассировка
EXPLAIN и логи
Собирает информацию здесь и сейчас
# Динамичесская трасиировка
Специальные точки - пробы, которые срабатывают при определённых событиях служат источником данных
Нагружает систему, так что необходимо чётко прописывать для чего её использовать
Не эффективно для бд с высокой изменчивостью
Можно гибко настроить параметры отслеживания
## Инструменты
- auto_explain
- pg_stat_activity - просмотр запросов, которые выполняются в данный момент
- pg_locks - отображает блокировки
- DTrace
- perf / eBPF
- EXPLAIN ANALYSE?
## Когда использовать
- Пики нагрузки (периодические)
- Редкие и трудно воспроизводимые ошибки
- блокировки таблиц
- Внезапный рост таблиц
## Не стоит использовать для
- Высоконагруженных систем
- В простых таблицах, где проще найти изъян вручную
