---
tags:
  - конспект
  - ⚛
  - инфобез
---

# Кибербезопасность и SOC
## Общие термины
- PII - персональные данные
- PHI - медицинская информация
- Кибервойна - атака на ресурсы другого государства
## Типы вредоносного ПО
### Вирус вымогатель
- Собирает и шифрует данные
- Требует за них выкуп
### Червь
- Способен распространяться без активного действия пользователя
- Использует уязвимости в ПО
- Самореплицируется и распространяется
#### Примеры
Stuxnet, повредивший Иранской ядерной программе
### Руткит 
Набор программных средств, предназначенный для увеличения прав пользователя
## Типы хакеров
### Непрофессионалы (Script Kiddy)
- Используют хакерское ПО из интернета
- Имеют мало навыков
- Взламывают из любопытства или чтобы продемонстрировать навыки
### Хактивисты
- Выступают против определённых политических идей
### Киберпреступники
- Взламывают для финансовой выгоды
### Государственные хакеры
- Промышленный шпионаж
- Кибервойны
- Взлом в интересах государства
## Элементы SOC
### Люди
- Аналитики 1 уровня - отслеживают и проверяют входящие оповещения, работают по шаблону
- Специалисты 2 уровня - реагирование на инциденты
- Специалист 3 уровня (эксперт в определённой области, охотник) - поиск и анализ угроз, внедрение инструментов, отслеживание работы вредоносного ПО 
- Руководитель - управляет всеми ресурсами SOC и является контактным лицом организации
### Технологии
#### SEIM система
- Сбор данных о событиях из разных источников
- Анализ и корреляция событий
- Мониторинг и контроль безопасности
- Управление журналами
- Оценка уязвимостей и анализ угроз
### Процессы
1) Аналитик 1 уровня получает алерты от SEIM
2) Фильтрует ложные сигналы
3) Пытается решить обращение
4) Передаёт на 2 уровень, если не получается
5) Аналогично 2 уровень передаёт на 3 уровень самые сложные проблемы
## Время бесперебойной работы
![[Pasted image 20251219134343.png]]
## Сертификация
CompTIA - CSA+
CISSP - $(ISC)^2$
Глобальная сертификация - GIAC
# ОС Windows
## Общие термины

## История 
DOS - дисковая операционная система, позже выкуплена Microsoft (MS-DOS)
Первая Windows - Windows 1.0 (1985 г), тоже дисковая
В дисковых ОС 1 пользователь и 1 процесс
 NT (New Technologies) это ОС с поддержкой нескольких пользовательских процессов.
 ![[Pasted image 20251219135554.png]]
## Команды CMD
- dir - отобразить списко файлов
- cd - сменить директорию
- copy - копировать
- del - удалить
- find - поиск текста в файле
- mkdir - создать директорию
- ren - переименовать
- help - справка
### Команда net
- **net accounts** - устанавливает требования к паролю и входу в систему для пользователей.
- **net session** - выводит список сеансов между компьютером и другими компьютерами в сети или закрывает эти сеансы.
- **net share** - создает, удаляет общие ресурсы или управляет ими.
- **net start** - запускает сетевую службу или выводит список запущенных сетевых служб.
- **net stop** - останавливает сетевую службу.
- **net use** - подключает, отключает общие сетевые ресурсы или выводит информацию о них.
- **net view** - отображает список компьютеров и сетевых устройств в сети.
### Команда netstat
Выводит информацию об активных подключениях
-a - показать все подключения
-b - вывести исполняемые файлы
-n - адрес и номер порта в числовом формате
-o - id каждого процесса
-r - таблица маршрутизации
## Безопасность Windows
- Не выключать Windows Defender
- Отслеживать выполняемые службы
- Включить шифрование (BitLocker)
- Настроить политику безопасности (secpol.msc)
- Windows Firewall
- Права на доступ к файлам
- Установка пароля
- Не использовать учётку админа
## Режимы ЦП
Драйверы могут работать в обоих режимах в зависимости от их назначения
### Пользовательский режим
- Выполняет код запущенных приложений
- Не имеет прямого аппаратного доступа
- Общается с оборудованием через вызовы к режиму ядра
### Режим ядра
- Выполняет код ОС
- Имеет неограниченный доступ к аппаратному ПО
- Может ссылаться на любой адрес памяти
- Предоставляет приложению ограниченное адресное пространство памяти
## Файловые системы
### FAT
Ограничена по максимальному размеру файла
FAT16 - диски до 4ГБ
FAT32 - диски до 8ТБ
exFAT - Не такие жёстки ограничения, но за пределами Windows почти не используется
### HFS+
Разработана для MAC OS
Не поддерживается Windows без специального ПО
### EXT
Файловая система Linux
Не поддерживается Windows без специального ПО
### NTFS (New Technology File System)
- Поддерживает очень большие файлы и разделы, а также хорошо совместима с другими операционными системами
- Очень надежна и поддерживает функции восстановления
- Разграничивает доступ к файлам через дескрипторы безопасности
- Дескрипторы безопасности содержат информацию о владельце файла и разрешениях вплоть до уровня файла
- Сохраняет временные метки MACE (Modify, Access, Create, Entry Modified)

NTFS хранит файлы в виде ряда атрибутов, таких как имя файла или метка времени. Данные, содержащиеся в файле, хранятся в атрибуте $DATA
Можно так же создать атрибут ADS (Alternative Data Stream) - метаданные файла

Чтобы увидеть наличие ADS надо вызвать команду dir с флагом /r
#### Структура NTFS
- Загрузочный сектор - первые 16 секторов диска, содержат местоположение таблицы MFT
- Копия загрузочного сектора - последние 16 секторов
- MFT - таблица со ссылками на все файлы с их атрибутами и метками времени
- Системные файлы - в них информация о других томах и атрибутах фалов
- Область фалов - в ней основные файлы и каталоги

При обычном форматировании удаляются данные только их таблицы MFT, но не из области файлов
## Процесс загрузки Windows
![[Pasted image 20251219142434.png]]
- MBR (Master Boot Record) - основная загрузочная запись, отвечает за загрузку OC BIOS
- Bootmgr.exe - переключает систему из реального режима в защищенный, считывает базу данных загрузочных конфигураций (BCD), и определяет, выполнен запуск или выход из режима гибернации
- KMCS - проверка цифровой подписи драйверов
- HAL - слой абстрагирования, реализованный в программном обеспечении, находящийся между физическим уровнем аппаратного обеспечения и программным обеспечением
- SMSS - подсистема диспетчера сеансов
## Процессы и потоки
- Приложению выделяется 1 или несколько процессов
- Процесс состоит из 1 и более потоков
- Потоки делят одно адресное пространство
- Процесс является службой, если работает в фоновом режиме
- Каждый процесс в компьютере с 64-разрядной ОС Windows поддерживает 8 ТБ виртуального адресного пространства, (только 4ГБ для 32 разрядной)
- RAMMap из пакета Sysinternal - утилита для просмотра выделения памяти
## Реестр Windows
Реестр — это иерархическая база данных, хранящая параметры системы. пользователей, аппаратного обеспечения и приложений
Типы значений реестра: 
- REG_BINARY - числа до 32 бит и логические значения
- REG_DWORD - числа больше 32 бит или необработанные данные
- REG_SZ - строковые значения

Так как в реестре содержится практически вся информация об операционной системе и пользователях, очень важно защитить его от несанкционированного доступа.

Есть 5 кустов, новые создавать нельзя
### HKEY_CURRENT_USER (HKCU)
содержит данные, относящиеся к пользователю, который в данный момент находится в системе.
### HKEY_USERS (HKU)
содержит данные, касающиеся всех учетных записей пользователей на хосте.
### HKEY_CLASSES_ROOT (HKCR)
содержит данные о регистрациях связывания и внедрения объектов (OLE).
### HKEY_LOCAL_MACHINE (HKLM)
содержит данные, относящиеся к системе.
### HKEY_CURRENT_CONFIG (HKCC)
содержит данные, относящиеся к системе.
## Пользователи
lustrmgr.msc - редактировать пользователей и группы пользователей 

Для упрощения администрирования пользователей в Windows используются группы, у каждой из которых свой набор полномочий
Пользователь может принадлежать сразу нескольким группам

Домен - это тип сетевой службы, в котором база данных хранит всех пользователей, группы, компьютеры, периферийные устройства и настройки безопасности, а также управляет ими
Хранится на контроллере домена
Настраивается для централизации AAA
## PowerShell
cmd на стероидах

help - список доступных команд
get-help \[-detailed\]\[-examples\]\[-full\] - справка по отдельной команде

Может создавать сценарии для автоматизации задач
Типы команд:
- Командлеты - выполняют действие и возвращают результат
- Скрипты - файлы с расширением PS1
- Функции PowerShell - фрагменты кода, к которым можно обращаться в скриптах
## Инструментарий управления Windows (WMI)
Предназначен для управления удаленными компьютерами 
- Извлечь информацию о компонентах компьютера, статистику аппаратного и программного обеспечения
- Наблюдать за работоспособностью удаленных компьютеров

Некоторые атаки пытаются использовать WMI для управления удалёнными хостами
## Протоколы удалённого доступа
### SMB
Доступ к файлам на удалённых хостах
Используется формат имен UNC
### RDP
Удалённый рабочий стол
## Журналы событий
Просмотр через event viewer
Есть журналы windows и журналы служб
# ОС Linux
## История
1991 г - Линус Торвальд выпустил первое ядро Линукс
UNIX -> GNU -> Linux
Linux создана сообществом программистов
Исходный код ядра Linux открыт и по лицензии его можно использовать как угодно
## Особенности Linux
- Небольшой размер
- Низкие требования к ресурсам
- Широкие возможности настройки
- Даёт высокую степень контроля над ОС
- Позволяет улучшить управление сетевым взаимодействием
- Имеет мощный интерфейс командной строки
## Дистрибутивы
- Red Hat
- Debian
- Ubuntu
- CentOS
- SUSE
- Kali - для пентеста
## Linux в SOC
Linux позволяет добавить в OS только минимум необходимых пакетов для работы
- Программное обеспечение для перехвата сетевых пакетов
- Средства анализа вредоносного ПО
- Системы обнаружения вторжений (IDS)
- Межсетевые экраны
- Диспетчеры журналов
- SIEM
- Системы регистрации заявок
## Команды
- mv - переместить файл
- chmod - настройка прав доступа файла
- chown - изменение владельца файла
- dd - копирование данных из ввода в вывод
- pwd - текущий каталог
- ps - активные процессы
- su - получение полномочий суперпользователя/эмуляция входа от лица др. пользователя
- man - справка по команде
- sudo - выполнение от имени супер пользователя
- ls - список фалов директории (-l с правами доступа) (-а + скрытые файлы)
- cd - смена каталога
- mkdir - создать директорию
- cp - копировать файл
- mv - переместить файл
- rm - удалить файл
- grep - поиск строк во входном потоке / файле регулярными выражениями
- cat - отобразить содержимое файла
- top - динамическое отображение активных процессов
- kill - остановить процесс принудительно
- | - передаёт вывод одной команды на вход следующей
## Текстовые редакторы
В линукс всё - файл: монитор, оперативка, диски, директории...
- nano
- vi
- vim
## Порты стандартных служб
- 21 - FTP
- 22 - SSH
- 23 - Telnet
- 25 - SMTP
- 53 - DNS
- 67 - DHCP сервер
- 68 - DHCP клиент
- 80 - HTTP
- 110 - POP3
- 123 - NTP (Network Time Protocol)
- 143 - IMAP
- 161/162 - SNMP
- 443 - HTTPS
- 8080 - Резервный HTTP
## Повышение надёжности устройств
- Физическая безопасность
- Минимальное число пакетов
- Отключить неиспользуемые службы
- Использовать SSHv2 без root
- Устанавливать обновления системы как можно быстрее
- Отключить автоматическое обнаружение USB
- Использовать надёжные пароли
- Не переиспользовать старые и скомпрометированные пароли
- Просматривать журналы
## Основные журналы Linux
- /var/log/messages (/var/log/syslog) - журналы общих, некритических операций
- /var/log/auth.log (/var/log/secure) - события аутентификции
- /var/log/boot.log - события во время загрузки системы
- /var/log/dmesg - сообщения кольцевого буффера ядра (от драйверов и аппаратных устройств)
- /var/log/kern.log - сообщения ядра
- /var/log/cron - сообщения планировщика задач
## Файловые системы
- ext2 - максимально простая, не ведёт журнал, хороша для флэшек
- ext3 - в случае перебоев с питанием в момент внесения изменений восстановит файл из журнала; макс размер файла до 32ТБ
- ext4 - развивается параллельно ex3, менее стабильна, позволяет отключать журнал
- NFS - сетевая файловая система, пользователь видит сетевые файлы как обычные
- CDFS - файловая система для компакт дисков
- HFS+ - подключается через модуль
- APFS - файловая система Apple с хорошим шифрованием
В линукс все физические диски монтируются в одно логическое пространство с помощью команды mount
## Типы ссылок
### Hard Link (Жёсткие ссылки)
Другой файл, указывающий на то же место в памяти
Создаются с помощью команды *ln*
Удаление оригинального файла с помощью rm не помешает получить к нему доступ через созданную жёсткую ссылку
Ограничены файловой системой
Нельзя создать жёсткую ссылку на директорию
### Symbolic Link (Символическая ссылка)
Ссылка, указывающая на путь к оригинальному файлу
Создаются с помощью команды *ln -s*
Удаление оригинального файла с помощью rm оставит ссылку недействительной
Могут указывать на файл в другой файловой системе
Может ссылаться на директорию
## GUI
### X Window (X/X11)
Система управления окнами
Работает как сервер, что позволяет обращаться к GUI удалённо
Предоставляет только базовый функционал окон и не отвечает за графику
Обеспечивает широкий спектр настроек (шрифты, иконки, кнопки, окна, цветовая схема...)
## Установка и запуск приложений
Установка осуществляется через apt/apt-get
Обновление установленных пакетов через apt-get upgrade
Обновление локальной базы данных метаданных пакетов apt-get update
## ПО
 chkrootkit - популярное приложение для поиска руткитов
 Не может гарантировать обнаружение 
# Сетевые службы и протоколы
## Типы сетей
- Домашняя сеть
- Небольшая офисная сеть (SOHO)
- Сети организаций
	- Intranet
	- Extranet
- Глобальные сети (Internet)
### Уровни сетей
- 1 и 2 уровень - объединение разных уровней интернета через точку обмена IXP
- 3 уровень - поставщики интернета

IXP (Internet eXchange Point) - точка соединения двух сетей 2 уровня
PoP - подключение 2 уровня к поставщику услуг (3 уровню)

### Модель OSI
- Уровень приложений: HTTP, DHCP, DNS, POP3, IMAP, SMB, SNMP
- Уровень представлений: Telnet, SSH, FTP, SMTP, SNMP
- Сеансовый уровень: SSL, RPC, NetBIOS
- Транспортный уровень: TCP, UDP, RDP
- Сетевой уровень: IPv4, IPv6, ARP, ICMP
- Канальный уровень: Ethernet, PPP, Token Ring
- Физический уровень: RS-232, Ethernet
#### Механизмы транспортного уровня
Сегментация - разбиение сообщения на части
Мультиплексирование - одновременное получение сообщений из 2 разных потоков
## Протоколы
Протокол - программа, которая действует по заданному набору правил
### Ethernet
IEEE 802.2/802.3
Управляет доступом к среде передачи данных
Кадр = преамбула (8 байт вида 101010101) + mac-получателя (6 байт) + mac-отправителя (6 байт) + EtherType (2 байта) + Данные (46-1500 байт) + FCS(4 байта контрольная сумма) = 1526 байт
Всё что больше 1518 - Jimbo-кадр
### IPv4
### Классы адресов
Класс А -  (от 0.0.0.0/8 до 127.0.0.0/8)
Класс B - (от 128.0.0.0/16 до 191.255.0.0/16)
Класс С - (от 192.0.0.0/24 до 223.255.255.0/24)
Класс D - (от 224.0.0.0 до 239.0.0.0) Широковещательный
Класс E - (от 240.0.0.0 до 255.0.0.0) Экспериментальный

В конце 1990-х классовая адресация была заменена бесклассовой

Блоки частных адресов:
- 10.0.0.0 /8 или от 10.0.0.0 до 10.255.255.255
- 172.16.0.0 /12 или от 172.16.0.0 до 172.31.255.255
- 192.168.0.0 /16 или от 192.168.0.0 до 192.168.255.255
Для частных IP преобразования в глобальные используется NAT
### IPv6
128 битный адрес
	2001:0D88:0000:0000:ACAD:0000:0000:0010:00FF

Состоит из 8 [[хекстет|хекстетов]] по 16 бит каждый

Первые 3 хекстета идентифицируют провайдера
4 хекстет - идентифицирует подсеть
остальные - адреса устройств
### ICMP
Из соображений безопасности сообщения ICMP не обязательны и часто даже не разрешены в сети.
Коды сообщений о недоступном хосте назначения
- **0** ― сеть недоступна
- **1** — хост недоступен
- **2** — протокол недоступен
- **3** — порт недоступен
### TCP
- Тройное рукопожатие - Установление соединения
	SYN-> 
	SYN, ACK <- 
	ACK->
- Четверное рукопожатие - разрыв соединения
	FIN -> 
	ACK <- 
	FIN <- 
	ACK ->

ISN - Номер сегмента в сообщении
Окно отправки - кол-во байт, которые можно отправить без подтверждения от сервера
MSS (Max Segment Size) - Максимальный размер сегмента
### DNS
Домен .io - британские острова в индийском океане
Домен .ai - домен Ангильи, британской самоуправляемой территории в карибском море

**RR** (запись ресурса) — формат, используемый в DNS-сообщениях, в котором имеются следующие поля: NAME, TYPE, CLASS, TTL, RDLENGTH и RDATA.

**FQDN** (полностью квалифицированное доменное имя) ― абсолютное имя устройства в распределенной базе данных DNS.

Типы записей ресурсов на DNS сервере
- **NS** — доверенный сервер имен
- **A** ― адрес IPv4 оконечного устройства
- **AAAA** — адрес IPv6 оконечного устройства.
- **MX** — запись обмена почтовыми сообщениями.

 Команда **к** выводит все DNS записи на компьютере
#### WHOIS
WHOIS ― это протокол на основе TCP, который используется для определения владельцев интернет-доменов в системе DNS
### NAT
Протокол преобразования частных IP адресов в глобальные
#### PAT
Версия протокола, которая преобразует порт + адрес = порт + адрес, таким образом несколько ip адресов могут получить доступ к интернету через 1 белый адрес
### Протоколы эл. почты
SMTP - отправка ,пересылка между серверами
POP3 - забрать с сервера
IMAP - скопировать с сервера
### HTTP
![[Pasted image 20251220001621.png]]
